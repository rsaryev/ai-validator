# ai-validator

ai-validator is a library that helps extract and validate structured data from the output text of language models.

[![npm](https://img.shields.io/npm/v/ai-validator)](https://www.npmjs.com/package/ai-validator)
[![Node.js Package](https://github.com/rsaryev/ai-validator/actions/workflows/npm-publish.yml/badge.svg)](https://github.com/rsaryev/ai-validator/actions/workflows/npm-publish.yml)

## Description

ai-validator is a powerful and flexible tool that allows you to validate and extract structured data from text generated by a language model.
It uses the zod library to create JSON schema. The schema is used to validate the structured data from the generated text and to generate a prompt for the language model.
This way you can build dynamic next-generation services.

## Installation

To install ai-validator, run the following command:

```bash
npm install ai-validator
```

## Usage

To use ai-validator, follow these steps:

### Import the necessary modules:

Install zod and openai `npm install zod openai`

```ts
import { AiValidator } from 'ai-validator';
import { z } from 'zod';
import { Configuration, OpenAIApi } from 'openai';
```

### Create a new instance of the OpenAI:

```ts
const configuration = new Configuration({apiKey: process.env.API_KEY});
const openai = new OpenAIApi(configuration);
```

### Define the validator:

Schema can be defined using the zod library. The validator can be created using the `AiValidator.input` template literal tag. The template literal tag accepts a string with the prompt and a schema object.

```ts
const schema = z.object({
    name: z.string().describe('Name of the person'),
    age: z.number().describe('Age of the person'),
});
const validator = AiValidator.input`My name is ${'John'}. I am ${30} years old. ${schema}`;
```

### Create a chat completion using the OpenAI API:

```ts
const completion = await openai.createChatCompletion({
    model: 'gpt-3.5-turbo',
    messages: [{role: 'user', content: validator.prompt()}],
});
```

### Parse the completion data using the validator:

The prompt can be generated using the `prompt` method of the validator. The prompt can be passed to the OpenAI API to generate a completion. The completion can be parsed using the `parse` method of the validator.

```ts
const parsed = validator.parse(completion.data.choices[0].message?.content);

console.log(parsed);
```

### The output will be:

The output will be an object with the following structure.

```json
{
  "name": "John",
  "age": 30
}
```

## Contributing

Contributions are always welcome!